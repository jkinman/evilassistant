[Unit]
Description=Evil Assistant - Demonic Voice Assistant
Documentation=https://github.com/jkinman/evilassistant
After=network-online.target sound.target pulseaudio.service
Wants=network-online.target
RequiresMountsFor=/home

[Service]
Type=simple
User=jkinman
Group=jkinman
SupplementaryGroups=audio
WorkingDirectory=/home/jkinman/evilassistant

# Environment setup
Environment=PATH=/home/jkinman/evilassistant/.venv/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
Environment=PYTHONPATH=/home/jkinman/evilassistant
Environment=PHILIPS_HUE_BRIDGE_IP=192.168.0.20
Environment=PULSE_RUNTIME_PATH=/run/user/1000/pulse
Environment=XDG_RUNTIME_DIR=/run/user/1000
Environment=LD_LIBRARY_PATH=/usr/lib:/usr/local/lib

# Main command
ExecStart=/home/jkinman/evilassistant/.venv/bin/python -m evilassistant

# Process management
Restart=always
RestartSec=10
StartLimitInterval=60
StartLimitBurst=3

# Security and resource limits
NoNewPrivileges=true
MemoryMax=2G
TasksMax=100

# Logging
StandardOutput=journal
StandardError=journal
SyslogIdentifier=evil-assistant

# Graceful shutdown
TimeoutStopSec=30
KillMode=mixed
KillSignal=SIGTERM

[Install]
WantedBy=multi-user.target
